<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>資訊 - PBLS VR教學平台</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- i18next -->
    <script src="https://unpkg.com/i18next@23.7.6/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-browser-languagedetector@7.2.0/i18nextBrowserLanguageDetector.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: transparent;
            min-height: 100vh;
            color: #333;
            position: relative;
        }

        /* 全局背景 */
        .global-bg {
            position: fixed;
            inset: 0; /* top, right, bottom, left 全为 0 */
            z-index: -1; /* 最底层 */
            pointer-events: none; /* 不阻挡点击 */
            background-image: url("./assets/背景.png");
            background-position: center calc(50% + 58px); /* 往下移2.3公分 */
            background-repeat: no-repeat;
            background-size: contain; /* 改为contain确保完整显示 */
            opacity: 0.9; /* 可依需求调整淡化程度 */
        }

        /* 确保内容在背景之上 */
        .main-content {
            position: relative;
            z-index: 1;
        }

        @media print {
            .global-bg { display: none; }
        }

        /* 毛玻璃卡片样式 */
        :root {
            --glass-alpha: .65;                /* 透明度 */
            --glass-border: rgba(255,255,255,.35);
            --glass-shadow: 0 10px 30px rgba(16,24,40,.12);
            --glass-radius: 20px;
            --glass-blur: 14px;
            --glass-bg: rgba(255,255,255,var(--glass-alpha));
        }

        .glass-card {
            background: var(--glass-bg);
            -webkit-backdrop-filter: saturate(160%) blur(var(--glass-blur));
            backdrop-filter: saturate(160%) blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--glass-radius);
            box-shadow: var(--glass-shadow);
        }

        /* 内容排版建议 */
        .glass-padding { padding: 28px; }
        .glass-title { font-size: 24px; font-weight: 800; color:#1f2937; }
        .glass-sub { font-size: 14px; color:#4b5563; }

        /* 兼容性/效能：若不支援 backdrop-filter 改高透明白 */
        @supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
            .glass-card { background: rgba(255,255,255,.85); }
        }

        /* 减少动效需求者降低透明特效 */
        @media (prefers-reduced-motion: reduce) {
            .glass-card { backdrop-filter: none; -webkit-backdrop-filter: none; }
        }

        /* 頂部標題欄 */
        .header {
            position: fixed;
            top: 0;
            left: 80px;
            right: 0;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease;
        }

        .sidebar:hover ~ .header {
            left: 180px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-title {
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            background: transparent;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            color: #333;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.1);
        }

        .logout-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e74c3c;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .logout-btn:hover {
            transform: scale(1.1);
        }

        /* 跑馬燈 */
        /* === 液態玻璃膠囊跑馬燈 === */
        :root { --pill-h: 56px; --pill-radius: 9999px; --pill-bg: rgba(255, 255, 255, 0.16); --pill-border: rgba(255, 255, 255, 0.28); --pill-shadow: 0 10px 30px rgba(0, 0, 0, 0.18); --pill-blur: 18px; --pill-pad-x: 18px; }
        .marquee.glass-pill { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); z-index: 999; height: var(--pill-h); min-width: min(92vw, 1200px); max-width: min(92vw, 1200px); display: flex; align-items: center; padding: 0 calc(var(--pill-pad-x) + 8px); border-radius: var(--pill-radius); background: var(--pill-bg); -webkit-backdrop-filter: blur(var(--pill-blur)) saturate(160%); backdrop-filter: blur(var(--pill-blur)) saturate(160%); border: 1px solid var(--pill-border); box-shadow: var(--pill-shadow); isolation: isolate; }
        .marquee .marquee-track { display: flex; align-items: center; gap: 28px; white-space: nowrap; will-change: transform; animation: marqueeScroll 26s linear infinite; }
        .marquee:hover .marquee-track { animation-play-state: paused; }
        .marquee .marquee-item { display: inline-flex; align-items: center; gap: 10px; color: #1f2937; font-size: 15px; font-weight: 600; letter-spacing: 0.2px; opacity: 0.9; }
        .marquee .marquee-item i { font-size: 16px; opacity: 0.9; }
        .marquee .pill-highlight { position: absolute; left: 6px; top: 50%; transform: translateY(-50%); width: 96px; height: calc(var(--pill-h) - 12px); border-radius: var(--pill-radius); background: radial-gradient(100px 60px at 20% 50%, rgba(0, 170, 255, 0.55), transparent 60%), radial-gradient(120px 80px at 45% 40%, rgba(64, 224, 255, 0.35), transparent 65%); filter: blur(6px) saturate(140%); mix-blend-mode: screen; pointer-events: none; }
        @keyframes marqueeScroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        @media (max-width: 768px) { :root { --pill-h: 50px; --pill-pad-x: 14px; } .marquee .marquee-item { font-size: 14px; } .marquee .pill-highlight { width: 84px; } }
        body.auth .marquee { display: none !important; }

        /* 側邊欄樣式 */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 80px;
            height: 100vh;
            background: rgba(147, 112, 219, 0.85);
            backdrop-filter: blur(20px);
            transition: width 0.3s ease;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.3), 
                         0 0 40px rgba(0, 0, 0, 0.1);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .sidebar:hover {
            width: 180px;
        }

        .sidebar-top {
            padding: 20px 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-container {
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }

        .logo-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
            transition: all 0.3s ease;
        }

        .sidebar:hover .logo-container {
            transform: scale(1.82);
        }

        .logo-container:hover .logo-image {
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .sidebar-menu {
            padding: 20px 0;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .sidebar-icon {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            margin: 5px 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-icon:hover,
        .sidebar-icon.active {
            background: rgba(52, 152, 219, 0.8);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .sidebar-icon i {
            font-size: 20px;
            color: white;
            min-width: 20px;
            margin-right: 15px;
        }

        .sidebar-icon span {
            color: white;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
        }

        /* 語言切換按鈕容器 - 固定在底部 */
        .language-switcher-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* 語言切換按鈕特殊樣式 */
        .language-switcher {
            background: rgba(46, 204, 113, 0.8) !important;
            border: 2px solid rgba(46, 204, 113, 0.6) !important;
            margin: 0;
        }

        .language-switcher:hover {
            background: rgba(39, 174, 96, 0.9) !important;
            border-color: rgba(39, 174, 96, 0.8) !important;
            transform: translateX(5px);
        }

        .language-switcher i {
            color: white !important;
        }

        .language-switcher span {
            color: white !important;
        }

        .sidebar:hover .sidebar-icon span {
            opacity: 1;
        }

        /* 主要內容區域 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-left: 80px;
            margin-top: 140px;
            padding: 20px 30px 40px 30px;
            min-height: calc(100vh - 180px);
        }

        .sidebar:hover ~ .main-content {
            margin-left: 180px;
        }

        /* PBLS 知識庫樣式 */
        .pbls-container {
            min-height: calc(100vh - 180px);
            background: linear-gradient(135deg, #f3e8ff 0%, #e0e7ff 100%);
            color: #333;
        }

        .hero-section {
            position: relative;
            padding: 100px 40px;
            text-align: center;
            border-radius: 25px;
            margin-bottom: 50px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.8s ease-in-out;
            animation: backgroundZoom 5s ease-in-out infinite;
        }

        @keyframes backgroundZoom {
            0%, 100% {
                background-size: 105% auto;
                transform: scale(1);
            }
            50% {
                background-size: 115% auto;
                transform: scale(1.03);
            }
        }

        .hero-section.changing {
            animation: zoomTransition 1.5s ease-in-out;
        }

        @keyframes zoomTransition {
            0% {
                transform: scale(1);
                filter: brightness(1);
            }
            50% {
                transform: scale(1.15);
                filter: brightness(1.3);
            }
            100% {
                transform: scale(1);
                filter: brightness(1);
            }
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1;
            border-radius: 25px;
            transition: background 0.3s ease;
        }

        .hero-section.changing::before {
            background: rgba(0, 0, 0, 0.5);
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 20px;
            color: white;
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.8);
            transition: all 0.3s ease;
        }

        .hero-description {
            font-size: 20px;
            max-width: 900px;
            margin: 0 auto 35px auto;
            line-height: 1.7;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
            transition: all 0.3s ease;
        }

        .hero-section.changing .hero-title {
            transform: scale(1.05);
            color: rgba(255, 255, 255, 0.9);
        }

        .hero-section.changing .hero-description {
            transform: scale(1.02);
            color: rgba(255, 255, 255, 0.8);
        }

        .learn-more-btn {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .learn-more-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
            background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
        }

        .section {
            padding: 40px 30px;
            margin-bottom: 30px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .section-white {
            background: transparent;
            text-align: center;
        }

        .section-purple {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
        }

        .section-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 30px;
            color: #4c1d95;
            text-align: center;
        }

        .flowchart-container {
            max-width: 100%;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .flowchart-image {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 15px;
        }

        .scenarios-grid {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            overflow-x: auto;
            padding: 10px;
        }

        .scenario-card {
            background: rgba(255, 255, 255, 0.1) !important;
            -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
            backdrop-filter: blur(20px) saturate(180%) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 20px !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1) !important;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            min-width: 250px;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }


        .scenario-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            border-color: #8b5cf6;
        }

        .scenario-image {
            width: 100%;
            height: 150px;
            border-radius: 15px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            font-size: 48px;
            overflow: hidden;
            position: relative;
        }

        .scenario-image img {
            width: 200px;
            height: 120px;
            object-fit: cover;
            border-radius: 15px;
            transition: transform 0.3s ease;
        }

        .scenario-card:hover .scenario-image img {
            transform: scale(1.05);
        }

        .scenario-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #4c1d95;
        }

        .scenario-btn {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
            background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
        }

        .simulation-btn-container {
            text-align: center;
            padding: 40px 30px;
        }

        .button-group {
            display: flex;
            gap: 25px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        .practice-btn, .exam-btn {
            border: none;
            padding: 18px 35px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .practice-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
        }

        .practice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.4);
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        .exam-btn {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.3);
        }

        .exam-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(245, 158, 11, 0.4);
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
        }


        /* 彈出視窗樣式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--glass-bg);
            -webkit-backdrop-filter: saturate(160%) blur(var(--glass-blur));
            backdrop-filter: saturate(160%) blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--glass-radius);
            box-shadow: var(--glass-shadow);
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.8) translateY(-50px);
            transition: all 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e5e7eb;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #4c1d95;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #9ca3af;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #f3f4f6;
            color: #6b7280;
        }

        .modal-body {
            font-size: 16px;
            line-height: 1.6;
            color: #374151;
        }

        .treatment-steps {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #8b5cf6;
        }

        .treatment-step {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .treatment-step:last-child {
            margin-bottom: 0;
        }

        .step-number {
            background: #8b5cf6;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .step-text {
            flex: 1;
        }

        /* 響應式設計 */
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }

            .sidebar:hover {
                width: 160px;
            }

            .main-content {
                margin-left: 60px;
            }

            .sidebar:hover ~ .main-content {
                margin-left: 160px;
            }

            .hero-section {
                padding: 80px 25px;
                min-height: 450px;
                margin-bottom: 30px;
            }

            .hero-title {
                font-size: 32px;
                margin-bottom: 15px;
            }

            .hero-description {
                font-size: 18px;
                padding: 0 15px;
                margin-bottom: 25px;
            }

            .section {
                padding: 30px 20px;
            }

            .scenarios-grid {
                gap: 15px;
                padding: 5px;
            }

            .scenario-card {
                min-width: 200px;
                padding: 15px;
            }

            .scenario-image {
                height: 120px;
            }

            .scenario-image img {
                width: 160px;
            }


            .button-group {
                flex-direction: column;
                gap: 20px;
            }

            .practice-btn, .exam-btn {
                min-width: 250px;
            }
        }
    </style>
    
    <!-- 語言切換功能 -->
    <script src="src/js/language-switcher.js"></script>
    <!-- 用戶資料服務 -->
    <script type="module" src="src/services/userDataService.js"></script>
</head>
<body>
    <!-- 全局背景 -->
    <div class="global-bg" aria-hidden="true"></div>
    
    <!-- 側邊欄 -->
    <div class="sidebar">
        <!-- 頂部：Logo -->
        <div class="sidebar-top">
            <div class="logo-container">
                <img src="assets/logo.png" alt="PBLS Logo" class="logo-image">
            </div>
        </div>

        <!-- 選單 -->
        <div class="sidebar-menu">
            <div class="sidebar-icon active" onclick="window.location.href='info.html'">
                <i class="fas fa-info-circle"></i>
                <span>資訊</span>
            </div>
            <div class="sidebar-icon" onclick="window.location.href='index.html'">
                <i class="fas fa-play-circle"></i>
                <span>練習專區</span>
            </div>
            <div class="sidebar-icon" onclick="window.location.href='exam.html'">
                <i class="fas fa-clipboard-list"></i>
                <span>考試專區</span>
            </div>
            <div class="sidebar-icon" onclick="window.location.href='history.html'">
                <i class="fas fa-chart-line"></i>
                <span>歷史成績</span>
            </div>
            <div class="sidebar-icon" onclick="window.location.href='team.html'">
                <i class="fas fa-users"></i>
                <span>團隊</span>
            </div>
        </div>

        <!-- 語言切換按鈕 - 固定在底部 -->
        <div class="language-switcher-container">
            <div class="sidebar-icon language-switcher" onclick="toggleLanguage()">
                <i class="fas fa-globe"></i>
                <span id="language-text">中文</span>
            </div>
        </div>
    </div>

    <!-- 頂部標題欄 -->
    <div class="header">
        <div class="header-left">
            <h1 class="header-title">歡迎使用PBLS教學平台</h1>
        </div>
        <div class="header-right">
            <div class="user-info" id="user-info-display">載入中...</div>
            <div class="user-avatar" onclick="showUserProfile()">
                <i class="fas fa-user"></i>
            </div>
            <div class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
            </div>
        </div>
    </div>

    <!-- 跑馬燈 -->
    <div class="marquee glass-pill" role="marquee" aria-label="最新公告">
        <div class="marquee-track">
            <div class="marquee-item"><i class="fas fa-bullhorn"></i> 歡迎使用PBLS VR教學平台！</div>
            <div class="marquee-item"><i class="fas fa-vr-cardboard"></i> 360°實境教學影片，身臨其境的學習體驗</div>
            <div class="marquee-item"><i class="fas fa-comments"></i> 虛擬人互動，提升急救溝通技巧</div>
            <div class="marquee-item"><i class="fas fa-gamepad"></i> VR實際操作，模擬真實急救情境</div>
            <div class="marquee-item"><i class="fas fa-chart-line"></i> 即時成績追蹤，掌握學習進度</div>
            <div class="marquee-item"><i class="fas fa-lightbulb"></i> 問題導向學習法，提升急救技能</div>
        </div>
        <span class="pill-highlight" aria-hidden="true"></span>
    </div>

    <!-- 主要內容區域 -->
    <div class="main-content">
        <div class="pbls-container">
            <!-- Hero Section -->
            <div class="hero-section" id="heroSection">
                <div class="hero-content">
                    <h1 class="hero-title">Pediatric Basic Life Support</h1>
                    <p class="hero-description">
                        Pediatric Basic Life Support (PBLS) is the essential guideline for rescuing infants and children in cardiac or respiratory arrest. This platform provides systematic training combining theory, process flow, and scenario simulations.
                    </p>
                    <button class="learn-more-btn" onclick="scrollToFlowchart()">
                        Learn More
                    </button>
                </div>
            </div>

            <!-- 流程圖區 -->
            <section class="section section-white" id="flowchart-section">
                <h2 class="section-title">PBLS 流程圖</h2>
                <div class="flowchart-container">
                    <img
                        src="/PBLS流程圖.png"
                        alt="PBLS流程圖"
                        class="flowchart-image"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                    />
                    <div style="display: none; padding: 40px; text-align: center; color: #666;">
                        <i class="fas fa-image" style="font-size: 48px; margin-bottom: 20px;"></i>
                        <p>PBLS流程圖圖片載入中...</p>
                        <p style="font-size: 14px; margin-top: 10px;">請確保圖片文件位於正確路徑</p>
                    </div>
                </div>
            </section>

            <!-- 五大情境模擬區 -->
            <section class="section section-purple">
                <h2 class="section-title">模擬情境案例</h2>
                <div class="scenarios-grid">
                    <div class="scenario-card">
                        <div class="scenario-image">
                            <img src="assets/心臟驟停情境.png" alt="心臟驟停情境" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div style="display: none; align-items: center; justify-content: center; width: 100%; height: 100%;">
                                <i class="fas fa-heartbeat"></i>
                            </div>
                        </div>
                        <h3 class="scenario-title">心臟驟停</h3>
                        <button class="scenario-btn" onclick="showTreatmentModal('cardiac')">
                            處理措施
                        </button>
                    </div>

                    <div class="scenario-card">
                        <div class="scenario-image">
                            <img src="assets/食物中毒情境.png" alt="食物中毒情境" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div style="display: none; align-items: center; justify-content: center; width: 100%; height: 100%;">
                                <i class="fas fa-utensils"></i>
                            </div>
                        </div>
                        <h3 class="scenario-title">食物中毒</h3>
                        <button class="scenario-btn" onclick="showTreatmentModal('poisoning')">
                            處理措施
                        </button>
                    </div>

                    <div class="scenario-card">
                        <div class="scenario-image">
                            <img src="assets/溺水情境.png" alt="溺水情境" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div style="display: none; align-items: center; justify-content: center; width: 100%; height: 100%;">
                                <i class="fas fa-swimmer"></i>
                            </div>
                        </div>
                        <h3 class="scenario-title">溺水</h3>
                        <button class="scenario-btn" onclick="showTreatmentModal('drowning')">
                            處理措施
                        </button>
                    </div>

                    <div class="scenario-card">
                        <div class="scenario-image">
                            <img src="assets/火災嗆傷情境.png" alt="火災嗆傷情境" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div style="display: none; align-items: center; justify-content: center; width: 100%; height: 100%;">
                                <i class="fas fa-fire"></i>
                            </div>
                        </div>
                        <h3 class="scenario-title">火災嗆傷</h3>
                        <button class="scenario-btn" onclick="showTreatmentModal('fire')">
                            處理措施
                        </button>
                    </div>

                    <div class="scenario-card">
                        <div class="scenario-image">
                            <img src="assets/外傷情境.png" alt="外傷情境" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div style="display: none; align-items: center; justify-content: center; width: 100%; height: 100%;">
                                <i class="fas fa-band-aid"></i>
                            </div>
                        </div>
                        <h3 class="scenario-title">外傷</h3>
                        <button class="scenario-btn" onclick="showTreatmentModal('trauma')">
                            處理措施
                        </button>
                    </div>
                </div>
            </section>

            <!-- 操作按鈕區 -->
            <div class="simulation-btn-container">
                <div class="button-group">
                    <button class="practice-btn" onclick="goToPractice()">
                        立即練習模擬
                    </button>
                    <button class="exam-btn" onclick="goToExam()">
                        進入考試測驗
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 彈出視窗 -->
    <div class="modal-overlay" id="treatmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">處理措施</h2>
                <button class="modal-close" onclick="closeTreatmentModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- 處理措施內容將在這裡動態插入 -->
            </div>
        </div>
    </div>

    <script>
        // 滾動到流程圖區域
        function scrollToFlowchart() {
            const flowchartSection = document.getElementById('flowchart-section');
            const offset = 100; // 向上偏移100px，避免滾動得太下面
            
            const elementPosition = flowchartSection.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - offset;
            
            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }

        // 跳轉到練習專區
        function goToPractice() {
            window.location.href = 'index.html';
        }

        // 跳轉到考試專區
        function goToExam() {
            window.location.href = 'exam.html';
        }


        // 處理措施資料
        const treatmentData = {
            cardiac: {
                title: '心臟驟停處理措施',
                steps: [
                    '立即進行CPR（心肺復甦術）',
                    '使用AED進行電擊除顫（50J）',
                    '給予Epinephrine（腎上腺素）',
                    '進行漸進式電擊治療',
                    '轉送ICU重症監護室'
                ]
            },
            poisoning: {
                title: '食物中毒處理措施',
                steps: [
                    '清理呼吸道，確保氣道暢通',
                    '使用Bag-Mask進行人工呼吸',
                    '進行CPR心肺復甦術',
                    '使用AED電擊除顫（80J）',
                    '給予Amiodarone（胺碘酮）'
                ]
            },
            drowning: {
                title: '溺水處理措施',
                steps: [
                    '抽吸呼吸道中的水分',
                    '使用Bag-Mask進行人工呼吸',
                    '進行CPR心肺復甦術',
                    '使用AED電擊除顫（60J）',
                    '給予Amiodarone（胺碘酮）'
                ]
            },
            fire: {
                title: '火災嗆傷處理措施',
                steps: [
                    '進行氣管插管並給予氧氣',
                    '進行CPR心肺復甦術',
                    '使用AED電擊除顫（80-100J）',
                    '給予Epinephrine（腎上腺素）'
                ]
            },
            trauma: {
                title: '外傷處理措施',
                steps: [
                    '進行止血並建立靜脈輸液',
                    '進行CPR心肺復甦術',
                    '使用AED電擊除顫（70J）',
                    '給予Epinephrine（腎上腺素）'
                ]
            }
        };

        // 顯示處理措施彈出視窗
        function showTreatmentModal(scenarioType) {
            const modal = document.getElementById('treatmentModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            
            // 使用全局翻譯數據或本地數據
            const data = window.treatmentData ? window.treatmentData[scenarioType] : treatmentData[scenarioType];
            if (!data) return;
            
            title.textContent = data.title;
            
            // 生成處理步驟HTML
            const stepsHtml = data.steps.map((step, index) => `
                <div class="treatment-step">
                    <div class="step-number">${index + 1}</div>
                    <div class="step-text">${step}</div>
                </div>
            `).join('');
            
            // 根據當前語言顯示不同的說明文字
            const currentLang = localStorage.getItem('pbls_language') || 'zh';
            const disclaimerText = currentLang === 'en' 
                ? '※ The above are basic treatment procedures. Actual operations need to be adjusted according to the situation.'
                : '※ 以上為基本處理流程，實際操作需依現場情況調整';
            
            body.innerHTML = `
                <div class="treatment-steps">
                    ${stepsHtml}
                </div>
                <p style="margin-top: 20px; font-size: 14px; color: #6b7280; text-align: center;">
                    ${disclaimerText}
                </p>
            `;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // 防止背景滾動
        }

        // 關閉處理措施彈出視窗
        function closeTreatmentModal() {
            const modal = document.getElementById('treatmentModal');
            modal.classList.remove('active');
            document.body.style.overflow = ''; // 恢復背景滾動
        }

        // 液態玻璃膠囊跑馬燈初始化
        function initGlassMarquee(){document.querySelectorAll('.marquee.glass-pill').forEach($m=>{const track=$m.querySelector('.marquee-track');if(!track)return;if(!track.dataset.cloned){track.innerHTML=track.innerHTML+track.innerHTML;track.dataset.cloned='1';}const totalWidth=Array.from(track.children).reduce((w,el)=>w+el.getBoundingClientRect().width+28,0);const sec=Math.max(18,Math.min(36,Math.round(totalWidth/80)));track.style.animationDuration=sec+'s';});}

        // 點擊背景關閉彈出視窗
        document.addEventListener('DOMContentLoaded', function() {
            initGlassMarquee();
            const modal = document.getElementById('treatmentModal');
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeTreatmentModal();
                }
            });
            
            // 初始化背景輪播
            initHeroBackground();
            
            // 檢查用戶登入狀態
            checkUserAuth();
        });

        // 檢查用戶認證狀態
        function checkUserAuth() {
            const currentUser = JSON.parse(localStorage.getItem('pbls_user') || 'null');
            
            if (!currentUser) {
                // 用戶未登入，跳轉到登入頁面
                alert('請先登入後再使用系統');
                window.location.href = 'login.html';
                return;
            }
            
            // 顯示用戶信息
            displayUserInfo(currentUser);
            
            // 使用用戶資料服務更新用戶資訊
            setTimeout(() => {
                updateUserInfoWithService();
            }, 1000);
        }

        // 顯示用戶信息
        function displayUserInfo(user) {
            const userInfoDisplay = document.getElementById('user-info-display');
            if (userInfoDisplay && user) {
                const where = user.where || '未知單位';
                const department = user.department || '未知部門';
                userInfoDisplay.textContent = `${where}, ${department}`;
            }
        }

        // 使用用戶資料服務更新用戶資訊顯示
        function updateUserInfoWithService() {
            if (window.userDataService && window.userDataService.isLoggedIn()) {
                const userInfoDisplay = document.getElementById('user-info-display');
                if (userInfoDisplay) {
                    userInfoDisplay.textContent = window.userDataService.getUserInfo();
                }
            }
        }

        // 初始化 Hero Section 背景輪播
        function initHeroBackground() {
            const heroSection = document.getElementById('heroSection');
            const backgroundImages = [
                'assets/場景1.png',
                'assets/場景2.png',
                'assets/場景3.png',
                'assets/場景4.png'
            ];
            
            let currentImageIndex = 0;
            
            // 設置初始背景
            heroSection.style.backgroundImage = `url('${backgroundImages[currentImageIndex]}')`;
            
            // 每5秒切換背景
            setInterval(() => {
                // 添加切換動畫類
                heroSection.classList.add('changing');
                
                // 延遲更換背景圖片，讓動畫效果更明顯
                setTimeout(() => {
                    currentImageIndex = (currentImageIndex + 1) % backgroundImages.length;
                    heroSection.style.backgroundImage = `url('${backgroundImages[currentImageIndex]}')`;
                }, 750);
                
                // 移除動畫類
                setTimeout(() => {
                    heroSection.classList.remove('changing');
                }, 1500);
                
            }, 5000);
        }

        // 語言切換功能已移至 enhanced-language-manager.js


        // 添加卡片懸停效果
        document.addEventListener('DOMContentLoaded', function() {
            // 確保跑馬燈正常顯示
            const marquee = document.querySelector('.marquee');
            if (marquee) {
                console.log('✅ 跑馬燈元素已找到');
                marquee.style.display = 'flex';
            } else {
                console.error('❌ 找不到跑馬燈元素');
            }
            
            const scenarioCards = document.querySelectorAll('.scenario-card');
            
            scenarioCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-8px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });

            // 添加按鈕點擊動畫效果
            const buttons = document.querySelectorAll('.learn-more-btn, .practice-btn, .exam-btn, .scenario-btn');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
        });

        // 用戶頭像功能
        function showUserProfile() {
            alert('用戶資料功能開發中，敬請期待！');
        }

        // 登出功能
        function logout() {
            if (confirm('確定要登出嗎？')) {
                // 清除本地儲存
                localStorage.removeItem('pbls_user');
                localStorage.removeItem('pbls_user_profile');
                localStorage.removeItem('pbls_remember_me');
                
                // 跳轉到登入頁面
                window.location.href = 'login.html';
            }
        }
    </script>
    
    <!-- 載入增強的語言管理器 -->
    <script type="module">
        import './src/js/enhanced-language-manager.js';
    </script>
</body>
</html>
