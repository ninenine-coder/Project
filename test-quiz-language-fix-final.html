<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¬é©—èªè¨€åˆ‡æ›ä¿®å¾©æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #fff;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .status {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #4CAF50;
        }
        .problem-section {
            background: rgba(255, 152, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #ff9800;
        }
        .solution-section {
            background: rgba(33, 150, 243, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #2196f3;
        }
        .technical-details {
            background: rgba(255, 193, 7, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
            font-family: 'Courier New', monospace;
        }
        .checklist {
            background: rgba(76, 175, 80, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #4CAF50;
        }
        .checklist ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .checklist li {
            margin: 5px 0;
        }
        .comparison-table {
            background: rgba(33, 150, 243, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #2196f3;
        }
        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .comparison-table th,
        .comparison-table td {
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px;
            text-align: left;
        }
        .comparison-table th {
            background: rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ¸¬é©—èªè¨€åˆ‡æ›ä¿®å¾©æ¸¬è©¦</h1>
        
        <div class="test-section">
            <h2>ğŸ¯ ä¿®å¾©çš„å•é¡Œ</h2>
            <div class="problem-section">
                <h3>âŒ ä¿®å¾©å‰çš„å•é¡Œï¼š</h3>
                <ul>
                    <li><strong>é¡Œç›®å’Œé¸é …èªè¨€ä¸åŒæ­¥</strong>ï¼šé¡Œç›®æ˜¯ä¸­æ–‡ï¼Œé¸é …æ˜¯è‹±æ–‡</li>
                    <li><strong>é¸æ“‡é¸é …å¾Œç•¶æ‰</strong>ï¼šé»æ“Šé¸é …å¾Œé é¢ç„¡éŸ¿æ‡‰æˆ–å‡ºç¾éŒ¯èª¤</li>
                    <li><strong>èªè¨€åˆ‡æ›å‡½æ•¸ç¼ºå¤±</strong>ï¼šhandleQuizLanguageSwitch å‡½æ•¸æœªå®šç¾©</li>
                    <li><strong>éŒ¯èª¤è™•ç†ä¸è¶³</strong>ï¼šæ²’æœ‰é©ç•¶çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</li>
                </ul>
            </div>
            
            <div class="solution-section">
                <h3>âœ… ä¿®å¾©å¾Œçš„è§£æ±ºæ–¹æ¡ˆï¼š</h3>
                <ul>
                    <li><strong>æ·»åŠ èªè¨€åˆ‡æ›è™•ç†å‡½æ•¸</strong>ï¼šhandleQuizLanguageSwitch å‡½æ•¸å·²æ­£ç¢ºå®šç¾©</li>
                    <li><strong>ä¿®å¾©é¡Œç›®é¸é …åŒæ­¥</strong>ï¼šdisplayQuestionForLanguageSwitch å‡½æ•¸æœƒé‡æ–°è¼‰å…¥æ–°èªè¨€ç‰ˆæœ¬çš„é¡Œç›®</li>
                    <li><strong>å¢å¼·éŒ¯èª¤è™•ç†</strong>ï¼šç‚ºæ‰€æœ‰é—œéµå‡½æ•¸æ·»åŠ äº† try-catch éŒ¯èª¤è™•ç†</li>
                    <li><strong>ç‹€æ…‹ç®¡ç†æ”¹é€²</strong>ï¼šé˜²æ­¢åœ¨è½‰æ›éç¨‹ä¸­é€²è¡Œèªè¨€åˆ‡æ›</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ”§ æŠ€è¡“ä¿®å¾©è©³æƒ…</h2>
            <div class="technical-details">
<h4>1. æ·»åŠ èªè¨€åˆ‡æ›è™•ç†å‡½æ•¸ï¼š</h4>
<pre>function handleQuizLanguageSwitch() {
    // æª¢æŸ¥æ˜¯å¦åœ¨è½‰æ›ä¸­
    if (window.isTransitioning && window.isTransitioning()) {
        return; // å¿½ç•¥èªè¨€åˆ‡æ›è«‹æ±‚
    }
    
    // æ ¹æ“šä½œç­”ç‹€æ…‹æ±ºå®šè¡Œç‚º
    const isAnswered = window.isCurrentQuestionAnswered && window.isCurrentQuestionAnswered();
    if (isAnswered) {
        window.displayNextQuestionAfterLanguageSwitch();
    } else {
        window.displayQuestionForLanguageSwitch();
    }
}</pre>

<h4>2. ä¿®å¾©é¡Œç›®é¸é …åŒæ­¥ï¼š</h4>
<pre>async function displayQuestionForLanguageSwitch() {
    // é‡æ–°è¼‰å…¥æ–°èªè¨€ç‰ˆæœ¬çš„é¡Œç›®æ–‡ä»¶
    const currentLang = localStorage.getItem('pbls_language') || 'zh';
    const questionFile = currentLang === 'en' ? 'data/questions_en.json' : 'data/questions.json';
    
    // æ›´æ–°ç•¶å‰é¡Œç›®ç‚ºæ–°èªè¨€ç‰ˆæœ¬
    const newQuestions = await fetch(questionFile).then(r => r.json());
    const newQuestion = newQuestions.find(q => q.id === originalQuestionId);
    selectedQuestions[currentQuestionIndex] = newQuestion;
    
    // æ›´æ–°é¡Œç›®å’Œé¸é …æ–‡å­—
    document.getElementById('question-text').textContent = question.question;
    // æ›´æ–°é¸é …æ–‡å­—...
}</pre>

<h4>3. å¢å¼·éŒ¯èª¤è™•ç†ï¼š</h4>
<pre>function selectOption(optionIndex) {
    try {
        // åŸæœ‰çš„é¸æ“‡é‚è¼¯...
    } catch (error) {
        console.error('Error in selectOption:', error);
        // é‡ç½®ç‹€æ…‹ä»¥é˜²æ­¢é é¢ç•¶æ‰
        isNextLocked = false;
        isTransitioning = false;
        enableAllButtons();
    }
}</pre>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š ä¿®å¾©å‰å¾Œå°æ¯”</h2>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>å•é¡Œ</th>
                            <th>ä¿®å¾©å‰</th>
                            <th>ä¿®å¾©å¾Œ</th>
                            <th>ç‹€æ…‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>èªè¨€åˆ‡æ›å‡½æ•¸</strong></td>
                            <td>âŒ æœªå®šç¾©ï¼Œå°è‡´éŒ¯èª¤</td>
                            <td>âœ… æ­£ç¢ºå®šç¾©ä¸¦æš´éœ²åˆ°å…¨å±€</td>
                            <td>ğŸ”§ å·²ä¿®å¾©</td>
                        </tr>
                        <tr>
                            <td><strong>é¡Œç›®é¸é …åŒæ­¥</strong></td>
                            <td>âŒ é¡Œç›®ä¸­æ–‡ï¼Œé¸é …è‹±æ–‡</td>
                            <td>âœ… é¡Œç›®å’Œé¸é …èªè¨€ä¸€è‡´</td>
                            <td>ğŸ”§ å·²ä¿®å¾©</td>
                        </tr>
                        <tr>
                            <td><strong>é¸æ“‡é¸é …ç•¶æ‰</strong></td>
                            <td>âŒ é»æ“Šé¸é …å¾Œé é¢ç„¡éŸ¿æ‡‰</td>
                            <td>âœ… æ­£å¸¸è™•ç†é¸æ“‡ä¸¦è·³è½‰</td>
                            <td>ğŸ”§ å·²ä¿®å¾©</td>
                        </tr>
                        <tr>
                            <td><strong>éŒ¯èª¤è™•ç†</strong></td>
                            <td>âŒ æ²’æœ‰éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</td>
                            <td>âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œæ¢å¾©</td>
                            <td>ğŸ”§ å·²ä¿®å¾©</td>
                        </tr>
                        <tr>
                            <td><strong>ç‹€æ…‹ç®¡ç†</strong></td>
                            <td>âŒ è½‰æ›éç¨‹ä¸­å¯èƒ½å‡ºç¾è¡çª</td>
                            <td>âœ… é˜²æ­¢è½‰æ›æœŸé–“çš„èªè¨€åˆ‡æ›</td>
                            <td>ğŸ”§ å·²ä¿®å¾©</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ§ª æ¸¬è©¦æ­¥é©Ÿ</h2>
            <div class="checklist">
                <h3>ğŸ“‹ æ¸¬é©—èªè¨€åˆ‡æ›ä¿®å¾©æ¸¬è©¦æµç¨‹</h3>
                <ol>
                    <li><strong>åŸºæœ¬èªè¨€åˆ‡æ›æ¸¬è©¦</strong>
                        <ul>
                            <li>å‰å¾€ç­†è©¦æ¸¬é©—é é¢</li>
                            <li>é–‹å§‹æ¸¬é©—ï¼Œç­‰å¾…ç¬¬ä¸€é¡Œé¡¯ç¤º</li>
                            <li>é»æ“Šèªè¨€åˆ‡æ›æŒ‰éˆ•</li>
                            <li>ç¢ºèªé¡Œç›®å’Œé¸é …éƒ½åˆ‡æ›åˆ°æ–°èªè¨€</li>
                        </ul>
                    </li>
                    
                    <li><strong>é¸æ“‡é¸é …æ¸¬è©¦</strong>
                        <ul>
                            <li>åœ¨ä»»æ„èªè¨€æ¨¡å¼ä¸‹é¸æ“‡ä¸€å€‹é¸é …</li>
                            <li>ç¢ºèªä¸æœƒç•¶æ‰ï¼Œæ­£å¸¸é¡¯ç¤ºè§£é‡‹</li>
                            <li>ç¢ºèªèƒ½æ­£å¸¸è·³è½‰åˆ°ä¸‹ä¸€é¡Œ</li>
                        </ul>
                    </li>
                    
                    <li><strong>èªè¨€åˆ‡æ›å¾Œé¸æ“‡æ¸¬è©¦</strong>
                        <ul>
                            <li>åˆ‡æ›èªè¨€å¾Œé¸æ“‡é¸é …</li>
                            <li>ç¢ºèªé¸æ“‡éç¨‹æ­£å¸¸</li>
                            <li>ç¢ºèªè·³è½‰åˆ°ä¸‹ä¸€é¡Œæ™‚èªè¨€ä¸€è‡´</li>
                        </ul>
                    </li>
                    
                    <li><strong>éŒ¯èª¤æ¢å¾©æ¸¬è©¦</strong>
                        <ul>
                            <li>å¿«é€Ÿåˆ‡æ›èªè¨€ä¸¦é¸æ“‡é¸é …</li>
                            <li>ç¢ºèªå³ä½¿å‡ºç¾éŒ¯èª¤ä¹Ÿèƒ½æ­£å¸¸æ¢å¾©</li>
                            <li>ç¢ºèªé é¢ä¸æœƒå®Œå…¨ç•¶æ‰</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ å¿«é€Ÿæ¸¬è©¦</h2>
            <a href="exam_quiz.html" class="button">ğŸ“ å‰å¾€ç­†è©¦æ¸¬é©—</a>
            <a href="exam.html" class="button">ğŸ“š å‰å¾€è€ƒè©¦å°ˆå€</a>
            <button class="button" onclick="testLanguageSync()">ğŸ”„ æ¸¬è©¦èªè¨€åŒæ­¥</button>
            <button class="button" onclick="testErrorHandling()">ğŸ›¡ï¸ æ¸¬è©¦éŒ¯èª¤è™•ç†</button>
        </div>

        <div class="status" id="status">
            <strong>æ¸¬è©¦ç‹€æ…‹ï¼š</strong>ç­‰å¾…æ¸¬è©¦...
        </div>

        <div class="test-section">
            <h2>ğŸ“Š é æœŸçµæœ</h2>
            <div class="checklist">
                <h3>âœ… ä¿®å¾©å¾Œæ‡‰è©²æ­£å¸¸å·¥ä½œçš„åŠŸèƒ½</h3>
                <ul>
                    <li><strong>èªè¨€åˆ‡æ›æ­£å¸¸</strong>ï¼šé¡Œç›®å’Œé¸é …éƒ½èƒ½æ­£ç¢ºåˆ‡æ›èªè¨€</li>
                    <li><strong>é¸æ“‡é¸é …ç©©å®š</strong>ï¼šé»æ“Šé¸é …å¾Œä¸æœƒç•¶æ‰ï¼Œæ­£å¸¸è™•ç†</li>
                    <li><strong>éŒ¯èª¤æ¢å¾©èƒ½åŠ›</strong>ï¼šå³ä½¿å‡ºç¾éŒ¯èª¤ä¹Ÿèƒ½è‡ªå‹•æ¢å¾©</li>
                    <li><strong>ç‹€æ…‹ç®¡ç†æ­£ç¢º</strong>ï¼šé˜²æ­¢è½‰æ›æœŸé–“çš„è¡çªæ“ä½œ</li>
                    <li><strong>ç”¨æˆ¶é«”é©—æµæš¢</strong>ï¼šæ•´å€‹æ¸¬é©—éç¨‹é †æš¢ç„¡é˜»</li>
                </ul>
                
                <h3>ğŸ¯ æ¸¬è©¦é‡é»</h3>
                <ul>
                    <li><strong>åŒæ­¥æ€§</strong>ï¼šç¢ºèªé¡Œç›®å’Œé¸é …èªè¨€å®Œå…¨åŒæ­¥</li>
                    <li><strong>ç©©å®šæ€§</strong>ï¼šç¢ºèªé¸æ“‡é¸é …å¾Œä¸æœƒç•¶æ‰</li>
                    <li><strong>æ¢å¾©æ€§</strong>ï¼šç¢ºèªéŒ¯èª¤æƒ…æ³ä¸‹èƒ½æ­£å¸¸æ¢å¾©</li>
                    <li><strong>ä¸€è‡´æ€§</strong>ï¼šç¢ºèªæ•´å€‹æ¸¬é©—éç¨‹èªè¨€ä¸€è‡´</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        function testLanguageSync() {
            const status = document.getElementById('status');
            status.innerHTML = '<strong>æ¸¬è©¦ç‹€æ…‹ï¼š</strong>ğŸ”„ èªè¨€åŒæ­¥æ¸¬è©¦ï¼šè«‹å‰å¾€ç­†è©¦æ¸¬é©—ï¼Œé–‹å§‹æ¸¬é©—å¾Œåˆ‡æ›èªè¨€ï¼Œç¢ºèªé¡Œç›®å’Œé¸é …éƒ½åˆ‡æ›åˆ°ç›¸åŒèªè¨€';
            status.className = 'status';
        }

        function testErrorHandling() {
            const status = document.getElementById('status');
            status.innerHTML = '<strong>æ¸¬è©¦ç‹€æ…‹ï¼š</strong>ğŸ›¡ï¸ éŒ¯èª¤è™•ç†æ¸¬è©¦ï¼šè«‹åœ¨æ¸¬é©—ä¸­å¿«é€Ÿåˆ‡æ›èªè¨€ä¸¦é¸æ“‡é¸é …ï¼Œç¢ºèªå³ä½¿å‡ºç¾å•é¡Œä¹Ÿèƒ½æ­£å¸¸æ¢å¾©';
            status.className = 'status';
        }

        // é é¢è¼‰å…¥æ™‚é¡¯ç¤ºç‹€æ…‹
        document.addEventListener('DOMContentLoaded', function() {
            const status = document.getElementById('status');
            status.innerHTML = '<strong>æ¸¬è©¦ç‹€æ…‹ï¼š</strong>âœ… æ¸¬é©—èªè¨€åˆ‡æ›ä¿®å¾©æ¸¬è©¦é é¢å·²è¼‰å…¥ï¼Œè«‹æŒ‰ç…§æ¸¬è©¦æ­¥é©Ÿé€²è¡Œæ¸¬è©¦';
            status.className = 'status';
        });
    </script>
</body>
</html>
